create database VagaFacil;
use VagaFacil;

-- Criação da tabela empresa e inserção de valores 
create table empresa (
		idEmpresa int primary key auto_increment,
        razao varchar(45),
        cnpj char(18)        
);

insert into empresa values (null,'coca-cola','45.997.418/0001-53'),
						   (null,'itaú','60.701.190/0001-04'),
                           (null,'burguer-king','13.574.594/0001-96'),
                           (null,'ford','03.470.727/0001-20'),
                           (null,'carrefour','45.543.915/0001-81'), 
                           (null,'continental','48.754.139/0001-57');
select * from empresa;

-- Criação da tabela filial e inserção de valores 
create table filial (
		idFilial int primary key auto_increment,
        cep char(9),
        rua varchar(60),
        numero decimal(4,0),
        complemento varchar(45),
        fkEmpresa int,
        foreign key (fkEmpresa) references empresa(idEmpresa)
)auto_increment = 50000;

insert into filial values (null,'04709-000','R. Arquiteto Olavo Redig de Campos','105','Chácara Santo Antônio (Zona Sul)','1'),
						  (null,'04344-020','R. Volkswagen','100','Jabaquara, São Paulo)','2'),
                          (null,'05690-000',' R. George Eastman','213','Vila Tramontano, São Paulo - SP','3'),
                          (null,'07042-010','Av. Sen. Adolf Schindling','131','Vila Endres, Guarulhos - SP','4');
select * from filial;

-- Criação da tabela usuario e inserção de valores 
create table usuario (
		idUsuario int primary key auto_increment,
        nome varchar(50),
        email varchar(100),
        senha varchar(18),
        telefone char(14),
        fkFilial int,
        foreign key (fkFilial) references filial(idFilial)
)auto_increment = 100000;

insert into usuario values (null,'felipe alves santos','felipe@gmail.com','felipe123','55011972311126','50000'),
						   (null,'luciano neves','luciano@outlook.com','luciano123','55011962322128','50001'),
                           (null,'gabriel neves','gabriel@outlook.com','gabriel123','55011934322144','50002'),
                           (null,'diego costa','diego@sptech.com','diego123','55011923322189','50003'),
                           (null,'rogério ceni','rogério@gmail.com','rogério123','55011914578156','50003');
select * from usuario;

-- Criação da tabela rua e inserção de valores 
create table rua (
		idRua int primary key auto_increment,
        nome varchar(45), -- logradouro 
        bairro varchar(45),
        cep char(9)
)auto_increment = 150000;

insert into rua values (null, 'Rua Antonio Bento', 'Jardim Paulista', '01432-000'),
					   (null, 'Rua Consolação', 'Cerqueira César', '01416-003'),
                       (null, 'Avenida Doutor Luís Rocha Miranda', 'Jabaquara', '04344‑010'),
                       (null, 'Rua dos Pinheiros', 'Pinheiros', '05422-000'),
                       (null, 'Alameda Itupiranga', 'Saúde', '04294‑090');
select * from rua;

-- Criação da tabela sensor e inserção de valores 
create table sensor(
		idsensor int primary key auto_increment,
		cep char(9), -- removido e colocado na tabela rua 
		numRua varchar(45),
		numSensor varchar(45)
)auto_increment=200000;

insert into sensor values (null,'04100-000', '202', '1'),
						  (null,'03100-000', '307', '2'),
                          (null,'03000-000', '472', '3'),
                          (null,'04500-000', '532', '4'),
                          (null,'04700-000', '298', '5'),
                          (null,'05300-000', '397', '6'),
                          (null,'05400-000', '485', '7'),
                          (null,'05800-000', '604', '8'),
                          (null,'01000-000', '200', '9'),
                          (null,'01300-000', '578', '10');
select * from sensor;

-- Criação da tabela dados e inserção de valores 
create table dados(
		idDados int primary key auto_increment,
		dataHora datetime,
		valor char(1),
		fkSensor int,
		foreign key(fksensor) references sensor(idsensor)
)auto_increment=250000;

-- Dados referenter aos sensores 
insert into dados values (null, '2023-04-10 07:00:00', '0', 200000),
						 (null, '2023-04-10 07:30:00', '0', 200000),
                         (null, '2023-04-10 08:00:00', '0', 200000),
                         (null, '2023-04-10 08:30:00', '1', 200000),
                         (null, '2023-04-10 09:00:00', '1', 200000),
                         (null, '2023-04-10 09:30:00', '1', 200000),
                         (null, '2023-04-10 10:00:00', '1', 200000),
                         (null, '2023-04-10 10:30:00', '1', 200000),
                         (null, '2023-04-10 11:00:00', '0', 200000),
                         (null, '2023-04-10 11:30:00', '0', 200000),
                         (null, '2023-04-10 12:00:00', '1', 200000),
                         (null, '2023-04-10 12:30:00', '1', 200000),
                         (null, '2023-04-10 13:00:00', '1', 200000),
                         (null, '2023-04-10 13:30:00', '1', 200000),
                         (null, '2023-04-10 14:00:00', '1', 200000),
                         (null, '2023-04-10 14:30:00', '1', 200000),
                         (null, '2023-04-10 15:00:00', '1', 200000),
                         (null, '2023-04-10 15:30:00', '0', 200000),
                         (null, '2023-04-10 16:00:00', '0', 200000),
                         (null, '2023-04-10 16:30:00', '0', 200000),
                         (null, '2023-04-10 17:00:00', '0', 200000),
                         (null, '2023-04-10 17:30:00', '1', 200000),
                         (null, '2023-04-10 18:00:00', '1', 200000),
                         (null, '2023-04-10 18:30:00', '1', 200000),
                         (null, '2023-04-10 19:00:00', '1', 200000),
                         (null, '2023-04-10 07:00:00', '1', 200001),
						 (null, '2023-04-10 07:30:00', '1', 200001),
                         (null, '2023-04-10 08:00:00', '0', 200001),
                         (null, '2023-04-10 08:30:00', '0', 200001),
                         (null, '2023-04-10 09:00:00', '0', 200001),
                         (null, '2023-04-10 09:30:00', '1', 200001),
                         (null, '2023-04-10 10:00:00', '1', 200001),
                         (null, '2023-04-10 10:30:00', '1', 200001),
                         (null, '2023-04-10 11:00:00', '0', 200001),
                         (null, '2023-04-10 11:30:00', '1', 200001),
                         (null, '2023-04-10 12:00:00', '1', 200001),
                         (null, '2023-04-10 12:30:00', '1', 200001),
                         (null, '2023-04-10 13:00:00', '1', 200001),
                         (null, '2023-04-10 13:30:00', '1', 200001),
                         (null, '2023-04-10 14:00:00', '1', 200001),
                         (null, '2023-04-10 14:30:00', '1', 200001),
                         (null, '2023-04-10 15:00:00', '1', 200001),
                         (null, '2023-04-10 15:30:00', '1', 200001),
                         (null, '2023-04-10 16:00:00', '0', 200001),
                         (null, '2023-04-10 16:30:00', '0', 200001),
                         (null, '2023-04-10 17:00:00', '0', 200001),
                         (null, '2023-04-10 17:30:00', '1', 200001),
                         (null, '2023-04-10 18:00:00', '1', 200001),
                         (null, '2023-04-10 18:30:00', '1', 200001),
                         (null, '2023-04-10 19:00:00', '0', 200001),
                         (null, '2023-04-10 07:00:00', '1', 200002),
						 (null, '2023-04-10 07:30:00', '1', 200002),
                         (null, '2023-04-10 08:00:00', '0', 200002),
                         (null, '2023-04-10 08:30:00', '1', 200002),
                         (null, '2023-04-10 09:00:00', '0', 200002),
                         (null, '2023-04-10 09:30:00', '1', 200002),
                         (null, '2023-04-10 10:00:00', '1', 200002),
                         (null, '2023-04-10 10:30:00', '1', 200002),
                         (null, '2023-04-10 11:00:00', '0', 200002),
                         (null, '2023-04-10 11:30:00', '1', 200002),
                         (null, '2023-04-10 12:00:00', '1', 200002),
                         (null, '2023-04-10 12:30:00', '1', 200002),
                         (null, '2023-04-10 13:00:00', '0', 200002),
                         (null, '2023-04-10 13:30:00', '1', 200002),
                         (null, '2023-04-10 14:00:00', '1', 200002),
                         (null, '2023-04-10 14:30:00', '1', 200002),
                         (null, '2023-04-10 15:00:00', '0', 200002),
                         (null, '2023-04-10 15:30:00', '1', 200002),
                         (null, '2023-04-10 16:00:00', '0', 200002),
                         (null, '2023-04-10 16:30:00', '0', 200002),
                         (null, '2023-04-10 17:00:00', '1', 200002),
                         (null, '2023-04-10 17:30:00', '1', 200002),
                         (null, '2023-04-10 18:00:00', '1', 200002),
                         (null, '2023-04-10 18:30:00', '1', 200002),
                         (null, '2023-04-10 19:00:00', '0', 200002),
                         (null, '2023-04-10 07:00:00', '1', 200003),
						 (null, '2023-04-10 07:30:00', '1', 200003),
                         (null, '2023-04-10 08:00:00', '0', 200003),
                         (null, '2023-04-10 08:30:00', '1', 200003),
                         (null, '2023-04-10 09:00:00', '0', 200003),
                         (null, '2023-04-10 09:30:00', '0', 200003),
                         (null, '2023-04-10 10:00:00', '1', 200003),
                         (null, '2023-04-10 10:30:00', '1', 200003),
                         (null, '2023-04-10 11:00:00', '0', 200003),
                         (null, '2023-04-10 11:30:00', '1', 200003),
                         (null, '2023-04-10 12:00:00', '0', 200003),
                         (null, '2023-04-10 12:30:00', '1', 200003),
                         (null, '2023-04-10 13:00:00', '0', 200003),
                         (null, '2023-04-10 13:30:00', '1', 200003),
                         (null, '2023-04-10 14:00:00', '1', 200003),
                         (null, '2023-04-10 14:30:00', '0', 200003),
                         (null, '2023-04-10 15:00:00', '0', 200003),
                         (null, '2023-04-10 15:30:00', '1', 200003),
                         (null, '2023-04-10 16:00:00', '0', 200003),
                         (null, '2023-04-10 16:30:00', '0', 200003),
                         (null, '2023-04-10 17:00:00', '1', 200003),
                         (null, '2023-04-10 17:30:00', '1', 200003),
                         (null, '2023-04-10 18:00:00', '0', 200003),
                         (null, '2023-04-10 18:30:00', '1', 200003),
                         (null, '2023-04-10 19:00:00', '1', 200003),
                         (null, '2023-04-10 07:00:00', '1', 200004),
						 (null, '2023-04-10 07:30:00', '1', 200004),
                         (null, '2023-04-10 08:00:00', '1', 200004),
                         (null, '2023-04-10 08:30:00', '1', 200004),
                         (null, '2023-04-10 09:00:00', '1', 200004),
                         (null, '2023-04-10 09:30:00', '0', 200004),
                         (null, '2023-04-10 10:00:00', '1', 200004),
                         (null, '2023-04-10 10:30:00', '1', 200004),
                         (null, '2023-04-10 11:00:00', '0', 200004),
                         (null, '2023-04-10 11:30:00', '1', 200004),
                         (null, '2023-04-10 12:00:00', '0', 200004),
                         (null, '2023-04-10 12:30:00', '1', 200004),
                         (null, '2023-04-10 13:00:00', '0', 200004),
                         (null, '2023-04-10 13:30:00', '1', 200004),
                         (null, '2023-04-10 14:00:00', '1', 200004),
                         (null, '2023-04-10 14:30:00', '0', 200004),
                         (null, '2023-04-10 15:00:00', '0', 200004),
                         (null, '2023-04-10 15:30:00', '1', 200004),
                         (null, '2023-04-10 16:00:00', '0', 200004),
                         (null, '2023-04-10 16:30:00', '1', 200004),
                         (null, '2023-04-10 17:00:00', '1', 200004),
                         (null, '2023-04-10 17:30:00', '1', 200004),
                         (null, '2023-04-10 18:00:00', '1', 200004),
                         (null, '2023-04-10 18:30:00', '1', 200004),
                         (null, '2023-04-10 19:00:00', '1', 200004),
                         (null, '2023-04-10 07:00:00', '1', 200005),
						 (null, '2023-04-10 07:30:00', '1', 200005),
                         (null, '2023-04-10 08:00:00', '1', 200005),
                         (null, '2023-04-10 08:30:00', '1', 200005),
                         (null, '2023-04-10 09:00:00', '1', 200005),
                         (null, '2023-04-10 09:30:00', '0', 200005),
                         (null, '2023-04-10 10:00:00', '1', 200005),
                         (null, '2023-04-10 10:30:00', '1', 200005),
                         (null, '2023-04-10 11:00:00', '0', 200005),
                         (null, '2023-04-10 11:30:00', '1', 200005),
                         (null, '2023-04-10 12:00:00', '0', 200005),
                         (null, '2023-04-10 12:30:00', '1', 200005),
                         (null, '2023-04-10 13:00:00', '0', 200005),
                         (null, '2023-04-10 13:30:00', '1', 200005),
                         (null, '2023-04-10 14:00:00', '1', 200005),
                         (null, '2023-04-10 14:30:00', '0', 200005),
                         (null, '2023-04-10 15:00:00', '0', 200005),
                         (null, '2023-04-10 15:30:00', '1', 200005),
                         (null, '2023-04-10 16:00:00', '0', 200005),
                         (null, '2023-04-10 16:30:00', '1', 200005),
                         (null, '2023-04-10 17:00:00', '1', 200005),
                         (null, '2023-04-10 17:30:00', '1', 200005),
                         (null, '2023-04-10 18:00:00', '1', 200005),
                         (null, '2023-04-10 18:30:00', '1', 200005),
                         (null, '2023-04-10 19:00:00', '1', 200005),
                         (null, '2023-04-10 07:00:00', '0', 200006),
						 (null, '2023-04-10 07:30:00', '1', 200006),
                         (null, '2023-04-10 08:00:00', '1', 200006),
                         (null, '2023-04-10 08:30:00', '0', 200006),
                         (null, '2023-04-10 09:00:00', '1', 200006),
                         (null, '2023-04-10 09:30:00', '0', 200006),
                         (null, '2023-04-10 10:00:00', '1', 200006),
                         (null, '2023-04-10 10:30:00', '1', 200006),
                         (null, '2023-04-10 11:00:00', '0', 200006),
                         (null, '2023-04-10 11:30:00', '1', 200006),
                         (null, '2023-04-10 12:00:00', '1', 200006),
                         (null, '2023-04-10 12:30:00', '1', 200006),
                         (null, '2023-04-10 13:00:00', '0', 200006),
                         (null, '2023-04-10 13:30:00', '0', 200006),
                         (null, '2023-04-10 14:00:00', '1', 200006),
                         (null, '2023-04-10 14:30:00', '0', 200006),
                         (null, '2023-04-10 15:00:00', '0', 200006),
                         (null, '2023-04-10 15:30:00', '1', 200006),
                         (null, '2023-04-10 16:00:00', '0', 200006),
                         (null, '2023-04-10 16:30:00', '1', 200006),
                         (null, '2023-04-10 17:00:00', '1', 200006),
                         (null, '2023-04-10 17:30:00', '0', 200006),
                         (null, '2023-04-10 18:00:00', '0', 200006),
                         (null, '2023-04-10 18:30:00', '1', 200006),
                         (null, '2023-04-10 19:00:00', '1', 200006),
                         (null, '2023-04-10 07:00:00', '0', 200007),
						 (null, '2023-04-10 07:30:00', '0', 200007),
                         (null, '2023-04-10 08:00:00', '1', 200007),
                         (null, '2023-04-10 08:30:00', '0', 200007),
                         (null, '2023-04-10 09:00:00', '1', 200007),
                         (null, '2023-04-10 09:30:00', '0', 200007),
                         (null, '2023-04-10 10:00:00', '1', 200007),
                         (null, '2023-04-10 10:30:00', '1', 200007),
                         (null, '2023-04-10 11:00:00', '0', 200007),
                         (null, '2023-04-10 11:30:00', '1', 200007),
                         (null, '2023-04-10 12:00:00', '1', 200007),
                         (null, '2023-04-10 12:30:00', '1', 200007),
                         (null, '2023-04-10 13:00:00', '1', 200007),
                         (null, '2023-04-10 13:30:00', '0', 200007),
                         (null, '2023-04-10 14:00:00', '1', 200007),
                         (null, '2023-04-10 14:30:00', '0', 200007),
                         (null, '2023-04-10 15:00:00', '0', 200007),
                         (null, '2023-04-10 15:30:00', '0', 200007),
                         (null, '2023-04-10 16:00:00', '1', 200007),
                         (null, '2023-04-10 16:30:00', '1', 200007),
                         (null, '2023-04-10 17:00:00', '1', 200007),
                         (null, '2023-04-10 17:30:00', '0', 200007),
                         (null, '2023-04-10 18:00:00', '0', 200007),
                         (null, '2023-04-10 18:30:00', '1', 200007),
                         (null, '2023-04-10 19:00:00', '1', 200007),
                         (null, '2023-04-10 07:00:00', '1', 200008),
						 (null, '2023-04-10 07:30:00', '0', 200008),
                         (null, '2023-04-10 08:00:00', '1', 200008),
                         (null, '2023-04-10 08:30:00', '0', 200008),
                         (null, '2023-04-10 09:00:00', '0', 200008),
                         (null, '2023-04-10 09:30:00', '0', 200008),
                         (null, '2023-04-10 10:00:00', '1', 200008),
                         (null, '2023-04-10 10:30:00', '1', 200008),
                         (null, '2023-04-10 11:00:00', '1', 200008),
                         (null, '2023-04-10 11:30:00', '1', 200008),
                         (null, '2023-04-10 12:00:00', '1', 200008),
                         (null, '2023-04-10 12:30:00', '1', 200008),
                         (null, '2023-04-10 13:00:00', '0', 200008),
                         (null, '2023-04-10 13:30:00', '0', 200008),
                         (null, '2023-04-10 14:00:00', '1', 200008),
                         (null, '2023-04-10 14:30:00', '0', 200008),
                         (null, '2023-04-10 15:00:00', '0', 200008),
                         (null, '2023-04-10 15:30:00', '1', 200008),
                         (null, '2023-04-10 16:00:00', '1', 200008),
                         (null, '2023-04-10 16:30:00', '1', 200008),
                         (null, '2023-04-10 17:00:00', '1', 200008),
                         (null, '2023-04-10 17:30:00', '0', 200008),
                         (null, '2023-04-10 18:00:00', '0', 200008),
                         (null, '2023-04-10 18:30:00', '1', 200008),
                         (null, '2023-04-10 19:00:00', '1', 200008),
                         (null, '2023-04-10 07:00:00', '1', 200009),
						 (null, '2023-04-10 07:30:00', '0', 200009),
                         (null, '2023-04-10 08:00:00', '1', 200009),
                         (null, '2023-04-10 08:30:00', '0', 200009),
                         (null, '2023-04-10 09:00:00', '0', 200009),
                         (null, '2023-04-10 09:30:00', '0', 200009),
                         (null, '2023-04-10 10:00:00', '1', 200009),
                         (null, '2023-04-10 10:30:00', '1', 200009),
                         (null, '2023-04-10 11:00:00', '0', 200009),
                         (null, '2023-04-10 11:30:00', '0', 200009),
                         (null, '2023-04-10 12:00:00', '1', 200009),
                         (null, '2023-04-10 12:30:00', '1', 200009),
                         (null, '2023-04-10 13:00:00', '0', 200009),
                         (null, '2023-04-10 13:30:00', '0', 200009),
                         (null, '2023-04-10 14:00:00', '1', 200009),
                         (null, '2023-04-10 14:30:00', '0', 200009),
                         (null, '2023-04-10 15:00:00', '1', 200009),
                         (null, '2023-04-10 15:30:00', '1', 200009),
                         (null, '2023-04-10 16:00:00', '1', 200009),
                         (null, '2023-04-10 16:30:00', '1', 200009),
                         (null, '2023-04-10 17:00:00', '1', 200009),
                         (null, '2023-04-10 17:30:00', '1', 200009),
                         (null, '2023-04-10 18:00:00', '0', 200009),
                         (null, '2023-04-10 18:30:00', '1', 200009),
                         (null, '2023-04-10 19:00:00', '0', 200009);
select * from dados;
-- select dataHora, SUM(valor) FROM dados group by dataHora;
-- alteração na tabela sensor, adição da coluna fkRua
alter table sensor drop column cep;
alter table sensor add column fkRua int;
alter table sensor add foreign key(fkRua) references rua(idRua);


update sensor set fkRua = 150000 where idSensor = 200000;
update sensor set fkRua =150001 where idSensor = 200001; 
update sensor set fkRua =150002 where idSensor = 200002; 
update sensor set fkRua =150003 where idSensor = 200003; 
update sensor set fkRua =150004 where idSensor = 200004; 
update sensor set fkRua =150002 where idSensor = 200005; 
update sensor set fkRua =150003 where idSensor = 200006; 
update sensor set fkRua =150000 where idSensor = 200007; 
update sensor set fkRua =150002 where idSensor = 200008; 
update sensor set fkRua =150002 where idSensor = 200009; 
select * from sensor;

-- select das tabelas relacionadas

select * from empresa join filial on fkEmpresa = idEmpresa;

select * from filial join usuario on fkFilial = idFilial;

select * from empresa join filial join usuario on fkEmpresa = idEmpresa and fkFilial = idFilial;

select * from rua join sensor on fkRua = idRua;

select * from sensor join dados on fkSensor = idSensor;

select * from rua join sensor join dados on fkRua = idRua and fkSensor = idSensor; 
drop database vagafacil;